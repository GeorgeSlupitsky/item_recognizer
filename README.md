# üß† Custom CNN Classifier for Collectibles

–¶–µ–π –ø—Ä–æ—î–∫—Ç ‚Äî –≤–µ–±–∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ –¥–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–æ–±—Ä–∞–∂–µ–Ω—å –∫–æ–ª–µ–∫—Ü—ñ–π–Ω–∏—Ö –ø—Ä–µ–¥–º–µ—Ç—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–≥–æ—Ä—Ç–∫–æ–≤–æ—ó –Ω–µ–π—Ä–æ–º–µ—Ä–µ–∂—ñ (CNN). –ö—Ä—ñ–º –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, –≤—ñ–Ω —Ç–∞–∫–æ–∂ –≤–∏—Ç—è–≥—É—î —Ç–µ–∫—Å—Ç –∑ —Ñ–æ—Ç–æ –∫–Ω–∏–≥ –∞–±–æ –≤—ñ–Ω—ñ–ª—ñ–≤ (OCR —á–µ—Ä–µ–∑ Tesseract).

## üß© –ö–ª–∞—Å–∏
- `books`
- `coins`
- `drumsticks`
- `stamps`
- `vinyls`

## üß± –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª—ñ

–ú–æ–¥–µ–ª—å —Å—Ç–≤–æ—Ä–µ–Ω–∞ –≤—Ä—É—á–Ω—É (custom CNN) –±–µ–∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –Ω–∞–≤—á–µ–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π. –í–æ–Ω–∞ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ —Ç–∞–∫–∏—Ö —à–∞—Ä—ñ–≤:

- 3 √ó `Conv2D` + `MaxPooling2D`
- `Flatten`
- `Dense(256)` + `Dropout(0.5)`
- `Dense(5, activation='softmax')`

```python
model = Sequential([
    Conv2D(32, (3, 3), activation='relu'),
    MaxPooling2D(),
    Conv2D(64, (3, 3), activation='relu'),
    MaxPooling2D(),
    Conv2D(128, (3, 3), activation='relu'),
    MaxPooling2D(),
    Flatten(),
    Dense(256, activation='relu'),
    Dropout(0.5),
    Dense(5, activation='softmax')
])
```

## ‚öôÔ∏è –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è

- üìê –†–æ–∑–º—ñ—Ä –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è: `224√ó224`
- üîÑ –ê—É–≥–º–µ–Ω—Ç–∞—Ü—ñ—è: –ø–æ–≤–æ—Ä–æ—Ç–∏, –∑—Å—É–≤, –∑—É–º, —Ñ–ª—ñ–ø
- ‚öñÔ∏è –ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –∫–ª–∞—Å—ñ–≤: `class_weight`
- üìä –°—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π train/test —Å–ø–ª—ñ—Ç: `80/20`
- üß† Optimizer: `Adam`
- ‚è± Epochs: `20`

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç–∏

- **Final Accuracy:** `75%`
- **Precision (macro avg):** `0.76`
- **Recall (macro avg):** `0.74`
- **F1-score (macro avg):** `0.75`

| Class        | Precision | Recall | F1-score |
|--------------|-----------|--------|----------|
| books        | 0.86      | 0.77   | 0.81     |
| coins        | 0.78      | 0.81   | 0.79     |
| drumsticks   | 0.94      | 0.66   | 0.78     |
| stamps       | 0.70      | 0.78   | 0.74     |
| vinyls       | 0.53      | 0.71   | 0.61     |

## üìä –ì—Ä–∞—Ñ—ñ–∫–∏

### üìå Confusion Matrix
![Confusion Matrix](confusion_matrix.png)

### üìå Accuracy / Loss
![Accuracy / Loss](accuracy_loss.png)


## üåê –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å

- –ü–æ–±—É–¥–æ–≤–∞–Ω–∏–π –Ω–∞ Flask
- Drag & Drop –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ (JS + CSS)
- –í–∏–≤–æ–¥–∏—Ç—å:
  - –ö–∞—Ç–µ–≥–æ—Ä—ñ—é
  - –í–ø–µ–≤–Ω–µ–Ω—ñ—Å—Ç—å
  - –¢–µ–∫—Å—Ç (–¥–ª—è –∫–Ω–∏–≥/–≤—ñ–Ω—ñ–ª—ñ–≤)

![](./interface_example.png)

## üì¶ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

```bash
poetry install
poetry shell
pip install tensorflow-macos tensorflow-metal
python app.py
```

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
.
‚îú‚îÄ‚îÄ app.py                          # Flask API –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ
‚îú‚îÄ‚îÄ utils.py                        # –§—É–Ω–∫—Ü—ñ—ó: –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è, OCR
‚îú‚îÄ‚îÄ best_custom_cnn.keras           # –ó–±–µ—Ä–µ–∂–µ–Ω–∞ –º–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ README.md                       # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
‚îú‚îÄ‚îÄ pyproject.toml                  # Poetry –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
‚îú‚îÄ‚îÄ poetry.lock                     # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ (–≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è)
‚îú‚îÄ‚îÄ .gitignore                      # –Ü–≥–Ω–æ—Ä—É—î —Ç–∏–º—á–∞—Å–æ–≤—ñ/–Ω–µ–ø–æ—Ç—Ä—ñ–±–Ω—ñ —Ñ–∞–π–ª–∏
‚îÇ
‚îú‚îÄ‚îÄ accuracy_loss.png               # –ì—Ä–∞—Ñ—ñ–∫ —Ç–æ—á–Ω–æ—Å—Ç—ñ —Ç–∞ –≤—Ç—Ä–∞—Ç
‚îú‚îÄ‚îÄ confusion_matrix.png            # –ú–∞—Ç—Ä–∏—Ü—è –ø–ª—É—Ç–∞–Ω–∏–Ω–∏
‚îÇ
‚îú‚îÄ‚îÄ static/                         # –°—Ç–∞—Ç–∏—á–Ω—ñ —Ñ–∞–π–ª–∏ (JS/CSS)
‚îÇ   ‚îú‚îÄ‚îÄ styles.css
‚îÇ   ‚îî‚îÄ‚îÄ script.js
‚îÇ
‚îú‚îÄ‚îÄ templates/                      # HTML —à–∞–±–ª–æ–Ω–∏ Flask
‚îÇ   ‚îî‚îÄ‚îÄ index.html
‚îÇ
‚îú‚îÄ‚îÄ test/                           # –¢–µ—Å—Ç–æ–≤—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
‚îÇ   ‚îú‚îÄ‚îÄ Coin.jpg
‚îÇ   ‚îú‚îÄ‚îÄ Drumstick.jpg
‚îÇ   ‚îú‚îÄ‚îÄ Stamp.jpg
‚îÇ   ‚îî‚îÄ‚îÄ Vinyl.jpg
‚îÇ
‚îú‚îÄ‚îÄ train_model/                    # –ù–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ
‚îÇ   ‚îú‚îÄ‚îÄ train_model_cnn.py
‚îÇ   ‚îî‚îÄ‚îÄ dataset.zip                 # Dataset
‚îÇ
‚îî‚îÄ‚îÄ image_collector/                # –ó–±—ñ—Ä –∑–æ–±—Ä–∞–∂–µ–Ω—å –∑ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—É
    ‚îú‚îÄ‚îÄ image_collector_ebay.py
    ‚îî‚îÄ‚îÄ image_collector_google.py
```
