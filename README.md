# üß† Classifier for Collectibles

–¶–µ–π –ø—Ä–æ—î–∫—Ç ‚Äî –≤–µ–±–∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ –¥–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–æ–±—Ä–∞–∂–µ–Ω—å –∫–æ–ª–µ–∫—Ü—ñ–π–Ω–∏—Ö –ø—Ä–µ–¥–º–µ—Ç—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∑–≥–æ—Ä—Ç–∫–æ–≤–æ—ó –Ω–µ–π—Ä–æ–º–µ—Ä–µ–∂—ñ (CNN).

## üß© –ö–ª–∞—Å–∏
- `books`
- `coins`
- `drumsticks`
- `stamps`
- `vinyls`

## üìö –î–∂–µ—Ä–µ–ª–∞ –¥–∞–Ω–∏—Ö

–î–ª—è —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏—Å—è –∫–æ–º–±—ñ–Ω–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ –∑ —Ç–∞–∫–∏—Ö –¥–∂–µ—Ä–µ–ª:

- üì¶ [Book Covers Dataset (Kaggle)](https://www.kaggle.com/datasets/lukaanicin/book-covers-dataset)
- üì¶ [Coin Image Dataset (Kaggle)](https://www.kaggle.com/datasets/mexwell/coin-image-dataset)
- üåê –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑ Google Images —Ç–∞ eBay (–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ —Å–∫—Ä–∏–ø—Ç–æ–º `image_collector`)
- üì∏ –í–ª–∞—Å–Ω—ñ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—ó –∑ –ø—Ä–∏–≤–∞—Ç–Ω–æ—ó –∫–æ–ª–µ–∫—Ü—ñ—ó

## üß± –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª—ñ

–ú–æ–¥–µ–ª—å –ø–æ–±—É–¥–æ–≤–∞–Ω–∞ –≤—Ä—É—á–Ω—É –Ω–∞ –±–∞–∑—ñ –∑–≥–æ—Ä—Ç–∫–æ–≤–æ—ó –Ω–µ–π—Ä–æ–Ω–Ω–æ—ó –º–µ—Ä–µ–∂—ñ (CNN):

- `3 √ó Conv2D + MaxPooling2D` ‚Äî –≤–∏–¥—ñ–ª–µ–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–∏—Ö —Ä–∏—Å –∑–æ–±—Ä–∞–∂–µ–Ω—å
- `Flatten` ‚Äî –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–µ–∫—Ç–æ—Ä–∞ –æ–∑–Ω–∞–∫ —É –ø–ª–æ—Å–∫–∏–π –≤–∏–≥–ª—è–¥
- `Dense(256) + Dropout(0.5)` ‚Äî –ø–æ–≤–Ω–æ–∑–≤'—è–∑–∞–Ω–∏–π —à–∞—Ä –¥–ª—è —É–∑–∞–≥–∞–ª—å–Ω–µ–Ω–Ω—è + —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü—ñ—è
- `Dense(5, activation='softmax')` ‚Äî –≤–∏—Ö—ñ–¥–Ω–∏–π —à–∞—Ä –¥–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –Ω–∞ 5 –∫–ª–∞—Å—ñ–≤

```python
model = Sequential([
    Conv2D(32, (3, 3), activation='relu'),
    MaxPooling2D(),
    Conv2D(64, (3, 3), activation='relu'),
    MaxPooling2D(),
    Conv2D(128, (3, 3), activation='relu'),
    MaxPooling2D(),
    Flatten(),
    Dense(256, activation='relu'),
    Dropout(0.5),
    Dense(5, activation='softmax')
])
```

## üß™ –Ü—Å—Ç–æ—Ä—ñ—è –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤

–ù–∞ –ø–æ—á–∞—Ç–∫—É –º–∏ –ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞–ª–∏ –∫—ñ–ª—å–∫–∞ –≤—ñ–¥–æ–º–∏—Ö –º–æ–¥–µ–ª–µ–π:

- ‚úÖ **Custom CNN** –ø–æ–∫–∞–∑–∞–ª–∞ –Ω–∞–π–∫—Ä–∞—â—É —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å —ñ –±–∞–ª–∞–Ω—Å —Ç–æ—á–Ω–æ—Å—Ç—ñ.
- ‚ùå **EfficientNetB0** –≤–∏–¥–∞–≤–∞–ª–∞ `nan` –≤—Ç—Ä–∞—Ç–∏ —ñ –º–∞–π–∂–µ –Ω–µ –≤—á–∏–ª–∞—Å—å.
- ‚ùå **ResNet50** —Ç–∞ **MobileNetV2** –¥–∞–≤–∞–ª–∏ –≤—ñ–¥—á—É—Ç–Ω–∏–π overfitting ‚Äî —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å –±—É–ª–∞ –≤–∏—Å–æ–∫–∞, –∞–ª–µ –Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ–≥—Ä–∞–¥—É–≤–∞–≤.

–ú–∏ –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É–≤–∞–ª–∏ –∑:
- `categorical` vs `sparse` loss —Ñ—É–Ω–∫—Ü—ñ—è–º–∏
- `OneHot` vs `integer labels`
- –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º `class_weight`
- —Ä—ñ–∑–Ω–∏–º–∏ –≤–∏–¥–∞–º–∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü—ñ–π
- –∑–º—ñ–Ω–æ—é –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∫–ª–∞—Å—ñ–≤
- –ø—ñ–¥–±–æ—Ä–æ–º –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤

## ‚öôÔ∏è –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è

- üìê –†–æ–∑–º—ñ—Ä –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è: `224√ó224`
- üîÑ –ê—É–≥–º–µ–Ω—Ç–∞—Ü—ñ—è: –ø–æ–≤–æ—Ä–æ—Ç–∏, –∑—Å—É–≤, –∑—É–º, —Ñ–ª—ñ–ø
- ‚öñÔ∏è –ë–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –∫–ª–∞—Å—ñ–≤: `class_weight`
- üìä –°—Ç—Ä–∞—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π train/test —Å–ø–ª—ñ—Ç: `80/20`
- üß† Optimizer: `Adam`
- ‚è± Epochs: `20`

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç–∏

- **Final Accuracy:** `75%`
- **Precision (macro avg):** `0.76`
- **Recall (macro avg):** `0.74`
- **F1-score (macro avg):** `0.75`

| Class        | Precision | Recall | F1-score |
|--------------|-----------|--------|----------|
| books        | 0.86      | 0.77   | 0.81     |
| coins        | 0.78      | 0.81   | 0.79     |
| drumsticks   | 0.94      | 0.66   | 0.78     |
| stamps       | 0.70      | 0.78   | 0.74     |
| vinyls       | 0.53      | 0.71   | 0.61     |

## üìå –ê–Ω–∞–ª—ñ–∑ —è–∫–æ—Å—Ç—ñ

–ú–æ–¥–µ–ª—å –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –Ω–∞–π–≤–∏—â—É —è–∫—ñ—Å—Ç—å –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –¥–ª—è –∫–ª–∞—Å—ñ–≤ `books`, `coins`, —ñ `drumsticks`:

- üìò **books** ‚Äî –º–∞—î –Ω–∞–π–≤–∏—â–∏–π F1-score (0.81), —Ç–æ–±—Ç–æ –º–æ–¥–µ–ª—å –¥—É–∂–µ –¥–æ–±—Ä–µ –≤–∏—è–≤–ª—è—î –∫–Ω–∏–≥–∏ —ñ —Ä—ñ–¥–∫–æ —ó—Ö –ø–ª—É—Ç–∞—î –∑ —ñ–Ω—à–∏–º–∏ –∫–ª–∞—Å–∞–º–∏.
- ü™ô **coins** ‚Äî –º–æ–¥–µ–ª—å –¥–æ–±—Ä–µ –≤–∏—è–≤–ª—è—î –º–æ–Ω–µ—Ç–∏ (Recall 0.81), –ø—Ä–æ—Ç–µ Precision —Ç—Ä–æ—Ö–∏ –Ω–∏–∂—á–∏–π (0.78), —Ç–æ–±—Ç–æ —î –Ω–µ–≤–µ–ª–∏–∫–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–º–∏–ª–∫–æ–≤–∏—Ö –ø–æ–∑–∏—Ç–∏–≤–Ω–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.
- ü•Å **drumsticks** ‚Äî –Ω–∞–π–±—ñ–ª—å—à–∞ Precision (0.94), —Ç–æ–±—Ç–æ —è–∫—â–æ –º–æ–¥–µ–ª—å –∫–ª–∞—Å–∏—Ñ—ñ–∫—É—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è —è–∫ –±–∞—Ä–∞–±–∞–Ω–Ω—ñ –ø–∞–ª–∏—á–∫–∏ ‚Äî —Ü–µ –º–∞–π–∂–µ –∑–∞–≤–∂–¥–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–æ—Ç–µ Recall —Ç—Ä–æ—Ö–∏ –Ω–∏–∂—á–∏–π (0.66), —â–æ –æ–∑–Ω–∞—á–∞—î, —â–æ –º–æ–¥–µ–ª—å —ñ–Ω–æ–¥—ñ –ø—Ä–æ–ø—É—Å–∫–∞—î —Å–ø—Ä–∞–≤–∂–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ drumsticks.

–î–ª—è —ñ–Ω—à–∏—Ö –∫–ª–∞—Å—ñ–≤:

- ‚úâÔ∏è **stamps** ‚Äî –º–∞—î –∑–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ Precision (0.70) —ñ Recall (0.78), —â–æ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ –∑–∞–≥–∞–ª–æ–º —Ö–æ—Ä–æ—à—É –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—é.
- üíø **vinyls** ‚Äî –Ω–∞–π–º–µ–Ω—à —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π –∫–ª–∞—Å. Recall (0.71) —Å–≤—ñ–¥—á–∏—Ç—å, —â–æ –º–æ–¥–µ–ª—å —á–∞—Å—Ç–æ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å –≤—ñ–Ω—ñ–ª–∏, –∞–ª–µ –Ω–∏–∑—å–∫–∞ Precision (0.53) –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ —á–∞—Å—Ç–æ –ø–æ–º–∏–ª–∫–æ–≤–æ –≤—ñ–¥–Ω–æ—Å–∏—Ç—å –¥–æ —Ü—ñ—î—ó –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó —ñ–Ω—à—ñ –æ–±'—î–∫—Ç–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–Ω–∏–≥–∏ —á–∏ –º–æ–Ω–µ—Ç–∏).

## üìä –ì—Ä–∞—Ñ—ñ–∫–∏

### üìå Confusion Matrix
![Confusion Matrix](confusion_matrix.png)

### üìå Accuracy / Loss
![Accuracy / Loss](accuracy_loss.png)

#### –ì—Ä–∞—Ñ—ñ–∫ "accuracy" (–∑–ª—ñ–≤–∞):
- **–°–∏–Ω—è –ª—ñ–Ω—ñ—è (`train accuracy`)** ‚Äî —Ç–æ—á–Ω—ñ—Å—Ç—å –Ω–∞ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ.
- **–ü–æ–º–∞—Ä–∞–Ω—á–µ–≤–∞ –ª—ñ–Ω—ñ—è (`val accuracy`)** ‚Äî —Ç–æ—á–Ω—ñ—Å—Ç—å –Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ–π–Ω—ñ–π –≤–∏–±—ñ—Ä—Ü—ñ.
- –ú–æ–¥–µ–ª—å **—Å—Ç–∞–±—ñ–ª—å–Ω–æ –ø–æ–∫—Ä–∞—â—É—î** —Ç–æ—á–Ω—ñ—Å—Ç—å –Ω–∞ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—ñ.
- –¢–æ—á–Ω—ñ—Å—Ç—å –Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó **–π–¥–µ –≤–≥–æ—Ä—É —Ä–∞–∑–æ–º —ñ–∑ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–æ—é**, —â–æ —î **—Ö–æ—Ä–æ—à–∏–º –∑–Ω–∞–∫–æ–º** ‚Äî –º–æ–¥–µ–ª—å **–Ω–µ –ø–µ—Ä–µ–Ω–∞–≤—á–∞—î—Ç—å—Å—è**.
- –Ñ –¥–µ—è–∫—ñ **–ø—Ä–æ–≤–∞–ª–∏** (–µ–ø–æ—Ö–∏ 8, 14), –∞–ª–µ **–∑–∞–≥–∞–ª—å–Ω–∞ —Ç–µ–Ω–¥–µ–Ω—Ü—ñ—è –∑—Ä–æ—Å—Ç–∞—é—á–∞** ‚Äî **–º–æ–¥–µ–ª—å –≤—á–∏—Ç—å—Å—è**.

#### üìâ –ì—Ä–∞—Ñ—ñ–∫ "loss" (—Å–ø—Ä–∞–≤–∞)
- **–°–∏–Ω—è –ª—ñ–Ω—ñ—è (`train loss`)** ‚Äî –∑–Ω–∞—á–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó –≤—Ç—Ä–∞—Ç –Ω–∞ —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö.
- **–ü–æ–º–∞—Ä–∞–Ω—á–µ–≤–∞ –ª—ñ–Ω—ñ—è (`val loss`)** ‚Äî –≤—Ç—Ä–∞—Ç–∏ –Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ–π–Ω–∏—Ö.
- –û–±–∏–¥–≤—ñ –∫—Ä–∏–≤—ñ **–ø–∞–¥–∞—é—Ç—å**, —â–æ –æ–∑–Ω–∞—á–∞—î **–∑–º–µ–Ω—à–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫** ‚Äî —Ü–µ –¥–æ–±—Ä–µ.
- –Ñ –∫—ñ–ª—å–∫–∞ **—Å–ø–ª–µ—Å–∫—ñ–≤ –≤—Ç—Ä–∞—Ç –Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó** (–µ–ø–æ—Ö–∏ ~8, ~14), –∞–ª–µ –≤–æ–Ω–∏ —à–≤–∏–¥–∫–æ –∑–≥–ª–∞–¥–∂—É—é—Ç—å—Å—è.

## üåê –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
![Accuracy / Loss](app_ui.png)
- –ü–æ–±—É–¥–æ–≤–∞–Ω–∏–π –Ω–∞ Flask
- Drag & Drop –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ (JS + CSS)
- –í–∏–≤–æ–¥–∏—Ç—å:
  - –ö–∞—Ç–µ–≥–æ—Ä—ñ—é
  - –í–ø–µ–≤–Ω–µ–Ω—ñ—Å—Ç—å


## üì¶ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

```bash
poetry install
poetry shell
pip install tensorflow-macos tensorflow-metal
python app.py
```

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
.
‚îú‚îÄ‚îÄ app.py                          # Flask API –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ
‚îú‚îÄ‚îÄ utils.py                        # –§—É–Ω–∫—Ü—ñ—ó: –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è, OCR
‚îú‚îÄ‚îÄ best_custom_cnn.keras           # –ó–±–µ—Ä–µ–∂–µ–Ω–∞ –º–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ README.md                       # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
‚îú‚îÄ‚îÄ pyproject.toml                  # Poetry –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
‚îú‚îÄ‚îÄ poetry.lock                     # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ (–≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è)
‚îú‚îÄ‚îÄ .gitignore                      # –Ü–≥–Ω–æ—Ä—É—î —Ç–∏–º—á–∞—Å–æ–≤—ñ/–Ω–µ–ø–æ—Ç—Ä—ñ–±–Ω—ñ —Ñ–∞–π–ª–∏
‚îÇ
‚îú‚îÄ‚îÄ accuracy_loss.png               # –ì—Ä–∞—Ñ—ñ–∫ —Ç–æ—á–Ω–æ—Å—Ç—ñ —Ç–∞ –≤—Ç—Ä–∞—Ç
‚îú‚îÄ‚îÄ confusion_matrix.png            # –ú–∞—Ç—Ä–∏—Ü—è –ø–ª—É—Ç–∞–Ω–∏–Ω–∏
‚îÇ
‚îú‚îÄ‚îÄ static/                         # –°—Ç–∞—Ç–∏—á–Ω—ñ —Ñ–∞–π–ª–∏ (JS/CSS)
‚îÇ   ‚îú‚îÄ‚îÄ styles.css
‚îÇ   ‚îî‚îÄ‚îÄ script.js
‚îÇ
‚îú‚îÄ‚îÄ templates/                      # HTML —à–∞–±–ª–æ–Ω–∏ Flask
‚îÇ   ‚îî‚îÄ‚îÄ index.html
‚îÇ
‚îú‚îÄ‚îÄ test/                           # –¢–µ—Å—Ç–æ–≤—ñ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
‚îÇ   ‚îú‚îÄ‚îÄ Coin.jpg
‚îÇ   ‚îú‚îÄ‚îÄ Drumstick.jpg
‚îÇ   ‚îú‚îÄ‚îÄ Stamp.jpg
‚îÇ   ‚îî‚îÄ‚îÄ Vinyl.jpg
‚îÇ
‚îú‚îÄ‚îÄ train_model/                    # –ù–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ
‚îÇ   ‚îú‚îÄ‚îÄ train_model_cnn.py
‚îÇ   ‚îî‚îÄ‚îÄ dataset.zip                 # Dataset
‚îÇ
‚îî‚îÄ‚îÄ image_collector/                # –ó–±—ñ—Ä –∑–æ–±—Ä–∞–∂–µ–Ω—å –∑ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—É
    ‚îú‚îÄ‚îÄ image_collector_ebay.py
    ‚îî‚îÄ‚îÄ image_collector_google.py
```
